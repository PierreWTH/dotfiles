"use strict";var s=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var b=(t,e)=>{for(var i in e)s(t,i,{get:e[i],enumerable:!0})},v=(t,e,i,l)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of x(e))!S.call(t,o)&&o!==i&&s(t,o,{get:()=>e[o],enumerable:!(l=k(e,o))||l.enumerable});return t};var $=t=>v(s({},"__esModule",{value:!0}),t);var E={};b(E,{default:()=>h});module.exports=$(E);var w=require("child_process"),n=require("@raycast/api");var c=require("child_process"),r=require("fs"),d=require("@raycast/api"),K="/Applications/kitty.app/Contents/MacOS/kitten",T=5e3;function P(){try{return(0,r.readdirSync)("/tmp").filter(t=>t.startsWith("kitty-socket-")).map(t=>`/tmp/${t}`).find(t=>(0,r.statSync)(t).isSocket())}catch{return}}function f(){let{socketPath:t}=(0,d.getPreferenceValues)();return t||P()||"/tmp/kitty-socket"}function F(t){let e=f(),i=`${K} @ --to unix:${e} ${t.join(" ")}`;return(0,c.execSync)(i,{encoding:"utf-8",timeout:T}).trim()}function a(){try{return(0,c.execSync)("pgrep -x kitty",{encoding:"utf-8",timeout:3e3}),!0}catch{return!1}}function u(){return(0,r.existsSync)(f())}function p(){(0,c.execSync)(`osascript -e 'tell application "kitty" to activate'`,{timeout:3e3})}function m(t){let e=t?.length?` --args ${t.join(" ")}`:"";(0,c.execSync)(`open -a kitty${e}`,{timeout:5e3})}function y(t){let e=["launch","--type=os-window"];t?.cwd&&e.push(`--cwd=${t.cwd}`),t?.title&&e.push(`--title=${t.title}`);let i=F(e);return parseInt(i,10)}function g(t){if(!a())return"not_running";if(!u())return"no_socket";let e=t instanceof Error?t.message:String(t);return e.includes("ETIMEDOUT")||e.includes("timed out")?"timeout":e.includes("Permission denied")||e.includes("remote control")?"remote_disabled":"unknown"}function I(){try{return(0,w.execSync)(`osascript -e '${`
      tell application "Finder"
        if (count of Finder windows) > 0 then
          set currentFolder to (target of front Finder window) as alias
          return POSIX path of currentFolder
        else
          return POSIX path of (desktop as alias)
        end if
      end tell
    `.replace(/'/g,"'\\''")}'`,{encoding:"utf-8",timeout:3e3}).trim()||null}catch{return null}}async function h(){try{let t=I();if(!t){await(0,n.showToast)({style:n.Toast.Style.Failure,title:"No folder selected",message:"Open a folder in Finder first"});return}if(!a()){await(0,n.showToast)({style:n.Toast.Style.Animated,title:"Launching Kitty...",message:t}),m(["--directory",t]),await(0,n.popToRoot)();return}if(!u()){await(0,n.showToast)({style:n.Toast.Style.Failure,title:"Socket not found",message:"Configure listen_on in kitty.conf and restart Kitty"});return}y({cwd:t}),p(),await(0,n.popToRoot)()}catch(t){let e=g(t);await(0,n.showToast)({style:n.Toast.Style.Failure,title:"Failed to open folder",message:e==="no_socket"?"Socket not found \u2014 check kitty.conf":String(t)})}}
