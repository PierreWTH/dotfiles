"use strict";var s=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var b=(t,n)=>{for(var i in n)s(t,i,{get:n[i],enumerable:!0})},S=(t,n,i,l)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!x.call(t,r)&&r!==i&&s(t,r,{get:()=>n[r],enumerable:!(l=h(n,r))||l.enumerable});return t};var v=t=>S(s({},"__esModule",{value:!0}),t);var P={};b(P,{default:()=>w});module.exports=v(P);var e=require("@raycast/api");var c=require("child_process"),o=require("fs"),d=require("@raycast/api"),K="/Applications/kitty.app/Contents/MacOS/kitten",$=5e3;function T(){try{return(0,o.readdirSync)("/tmp").filter(t=>t.startsWith("kitty-socket-")).map(t=>`/tmp/${t}`).find(t=>(0,o.statSync)(t).isSocket())}catch{return}}function f(){let{socketPath:t}=(0,d.getPreferenceValues)();return t||T()||"/tmp/kitty-socket"}function E(t){let n=f(),i=`${K} @ --to unix:${n} ${t.join(" ")}`;return(0,c.execSync)(i,{encoding:"utf-8",timeout:$}).trim()}function a(){try{return(0,c.execSync)("pgrep -x kitty",{encoding:"utf-8",timeout:3e3}),!0}catch{return!1}}function u(){return(0,o.existsSync)(f())}function p(){(0,c.execSync)(`osascript -e 'tell application "kitty" to activate'`,{timeout:3e3})}function m(t){let n=t?.length?` --args ${t.join(" ")}`:"";(0,c.execSync)(`open -a kitty${n}`,{timeout:5e3})}function y(t){let n=["launch","--type=os-window"];t?.cwd&&n.push(`--cwd=${t.cwd}`),t?.title&&n.push(`--title=${t.title}`);let i=E(n);return parseInt(i,10)}function g(t){if(!a())return"not_running";if(!u())return"no_socket";let n=t instanceof Error?t.message:String(t);return n.includes("ETIMEDOUT")||n.includes("timed out")?"timeout":n.includes("Permission denied")||n.includes("remote control")?"remote_disabled":"unknown"}async function w(){try{if(!a()){await(0,e.showToast)({style:e.Toast.Style.Animated,title:"Launching Kitty..."}),m(),await(0,e.popToRoot)();return}if(!u()){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Socket not found",message:"Configure listen_on in kitty.conf and restart Kitty"});return}y(),p(),await(0,e.popToRoot)()}catch(t){let n=g(t);await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Failed to open window",message:n==="no_socket"?"Socket not found \u2014 check kitty.conf":String(t)})}}
